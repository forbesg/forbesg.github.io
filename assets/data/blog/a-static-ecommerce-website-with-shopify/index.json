{"hash":"1c47bb26115c127816057d263a728c69449227f8","data":{"article":{"title":"A Static Ecommerce Website with Shopify","description":"Shopify has become one of the go-to ecommerce platforms. We can create a simple fast online shopping experience hooking in to the Shopify Storefront API.","tags":[{"id":"2","title":"Static Sites","path":"/blog/tags/static-sites/"},{"id":"3","title":"Ecommerce Websites","path":"/blog/tags/ecommerce-sites/"}],"subhead":"Using the Shopify Storefront API to create a fast unique e-commerce website","content":"<h2 id=\"the-storefront-api\"><a href=\"#the-storefront-api\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The Storefront API</h2>\n<p>When looking into possible ecommerce frameworks, it is hard not to stumble across Shopify. Over the past 5 to 10 years it has become a bit of a monster when it comes to the online shopping space. What has also been encoraging is that they have continued to innovate and lead the way in terms of development, and were quick to move with the times as the JAMstack trend took hold.</p>\n<p>The Storefront API allows access to the ecommerce store &#x26; product data via a GraphQL API which allows you to request precisely the information that you require to construct the page, keeping everything as lightweight as possible. In addition to this it handles customer authentication.</p>\n<h3 id=\"what-well-build\"><a href=\"#what-well-build\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What we'll build</h3>\n<p>I wanted to test <a href=\"https://shopify.dev/api/storefront\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Shopify's Storefront API</a>, so came up with a simple ecommerce grocery store idea to test the API.</p>\n<p>The beauty of this architecture is that you are able to access your store data through multiple channels (websites, apps, POS devices) whilst retaining the ability to manage your stores backend using Shopify's familiar and well-tested platform.</p>\n<p><img src=\"/images/articles/farm-foods-store.jpg\" alt=\"Farm Foods Store Screenshot\"></p>\n<h3 id=\"the-frontend\"><a href=\"#the-frontend\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The Frontend</h3>\n<p>For the frontend (website) I chose to use NuxtJS, however a similar approach could be taken with anu modern frontend web framework. With Nuxt I am able to choose whether to make the website a static site (pre-built and server as static pages) or server rendered (pages are constructed on every request). For this example I will be choosing to create a static build of the site which means it can be hosted for free and will be very fast.</p>\n<p>I styled the site a little using Tailwind css but we will not be going into the detail of that here. Tailwind was good for quickly creating a responsive website that doesn't look totally awful.</p>\n<p>The first step was to install a fresh version of NuxtJS and including tailwind.</p>\n<pre><code class=\"language-bash\">npx create-nuxt-app farm-foods-store\n\ncd farm-foods-store\nnpm install\n</code></pre>\n<p>With Nuxt installed we then need to add the node shopify api library to enable us to easily interact with the Storefront API.</p>\n<pre><code class=\"language-bash\">npm install @shopify/shopify-api\n</code></pre>\n<h3 id=\"setting-up-the-shopify-store\"><a href=\"#setting-up-the-shopify-store\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Setting Up The Shopify Store</h3>\n<p>First we need to create a Shopify Store to work with. Sign up or login to <a href=\"https://shopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Shopify</a> and create a new development store. Follow the setup guide to give the store a name, location and contact details and prompted to add some products.</p>\n<p>Once the store is created and we have some products to work with, we need to create a Private App to enable us to interact with the API securely. Enter your newly created store admin site and open the settings menu and select Apps and sales channels -> App development and Create an App.</p>\n<p>We give the new private app a name (e.g Storefront API) and scroll down to the Storefront API section. Check the box to allow the app to access storefront data and ensure that all subsequent permissions are checked. At the bottom of this section we can find the Storefront Access Token that we need to allow our website to access the API.</p>\n<h3 id=\"hook-up-our-website-to-the-api\"><a href=\"#hook-up-our-website-to-the-api\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Hook Up Our Website To The API</h3>\n<p>Now we have an access token for the Storefront API we need to give Nuxt the credentials needed to communicate with our stores backend. In the root of our Nuxt project create a .env file and include the following....</p>\n<pre><code class=\"language-bash\" class=\"env\">// .env\n\nNUXT_STORE_URL=https://&#x3C;the-store-name>.myshopify.com\nNUXT_STORE_API_ENDPOINT=https://&#x3C;the-store-name>.myshopify.com/api/2021-10/graphql.json\nNUXT_STORE_ACCESS_TOKEN=&#x3C;access token created in the previous step>\n</code></pre>\n<p>Nuxt automatically pulls in the environment variables from the .env file but we do need to make them accessible by the frontend of the site. This is easliy achieved using Nuxt's publicRuntimeConfig, values that can be access from the client side of the website. In the nuxt.config.js we can add the enviorment variables to the publicRuntimeConfig.</p>\n<pre><code class=\"language-javascript\">// nuxt.config.js\n\nconst storeUrl = process.env.NUXT_STORE_URL;\nconst storeAPIEndpoint = process.env.NUXT_STORE_API_ENDPOINT;\nconst storeAccessToken = process.env.NUXT_STORE_ACCESS_TOKEN;\n\nexport default {\n  ...\n  publicRuntimeConfig: {\n    storeUrl,\n    storeAPIEndpoint,\n    storeAccessToken,\n  },\n  ...\n};\n</code></pre>\n<h3 id=\"the-last-piece-of-the-jigsaw\"><a href=\"#the-last-piece-of-the-jigsaw\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The Last Piece of the Jigsaw</h3>\n<h4 id=\"connecting-to-the-shopify-api\"><a href=\"#connecting-to-the-shopify-api\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Connecting to the Shopify API</h4>\n<p>We have one final thing to do to enable requests to be made to the Shopify GraphQL API. We have installed the Shopify API library but we still need to give the site access to it and instantiate a client with the store API credentials.</p>\n<p>What we will do is create a <a href=\"https://nuxtjs.org/docs/directory-structure/plugins\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Nuxt plugin</a> to instatiate the client and then inject it into the Vue instance so we can call the API from anywhere within our application. Thanks to the Nuxt publicRuntimeConfig, we can access all the environment variables that we previously set up using the <code>$config</code> property passed to the plugin.</p>\n<pre><code class=\"language-javascript\">// ~/plugins/shopify.js\n\nexport default ({ app: { $config } }, inject) => {\n  const client = function(query, variables) {\n    return fetch($config.storeAPIEndpoint, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-Shopify-Storefront-Access-Token\": $config.storeAccessToken,\n      },\n      body: JSON.stringify({ query, variables: variables || null }),\n    });\n  };\n  inject(\"client\", client);\n};\n</code></pre>\n<p>As you can see we are setting up the client request with the necessary headers and passing in the GraphQL query and variables. Finally we inject the client function into the application context making it accessible using the app contexts <code>$client</code> property.</p>\n<p>Finally, let's make a request to the API from the products page asyncData method.</p>\n<pre><code class=\"language-javascript\">// ~/pages/products.vue\nexport default {\n  async asyncData({ $client }) {\n    const query = `\n      {\n        products (first: 3) {\n          edges {\n            node {\n              title\n              productType\n              description\n            }\n          }\n        }\n      }\n    `;\n\n    const {\n      data: { products },\n    } = await $client(query).then((res) => res.json());\n\n    /**  Shopify Storefront API Response\n      {\n        \"data\": {\n          \"products\": {\n            \"edges\": [\n              {\n                \"node\": {\n                  \"title\": \"Carrots\",\n                  \"productType\": \"Fresh &#x26; Frozen Vegetables\",\n                  \"description\": \"Fresh Carrots. Very Orange\"\n                }\n              },\n              {\n                \"node\": {\n                  \"title\": \"Broccoli\",\n                  \"productType\": \"Fresh &#x26; Frozen Vegetables\",\n                  \"description\": \"Fresh Broccoli. Very Green\"\n                }\n              },\n              {\n                \"node\": {\n                  \"title\": \"Cauliflower\",\n                  \"productType\": \"Fresh &#x26; Frozen Vegetables\",\n                  \"description\": \"Fresh Cauliflower. Very Tasty\"\n                }\n              }\n            ]\n          }\n        }\n      },\n    **/\n\n    return { products };\n  },\n};\n</code></pre>\n<p>The asyncData method will only be called during the build process of our static site and will make all the data returned in the response available to the page component and we can create and style the page however we would like.</p>\n<p>This approach of consuming Shopify ecommerce data really gives you limitless options when it comes to your UI and customer journey as well as providing customers with a fast and secure online shopping experience.</p>\n<p>View the half finished test <a href=\"https://farm-foods-store.netlify.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Farm Foods Store website</a></p>\n<p>If you would like to discuss your e-commerce project please do <a href=\"/contact/\">get in touch</a>.</p>\n","image":"/images/articles/shopify-graphql-jamstack.jpg.png","imageAlt":"Shopify Storefront API, GraphQL, Static Ecommerce Website","path":"/blog/a-static-ecommerce-website-with-shopify/","team":{"name":"Forbes Gray","twitter":"@4beez","path":"/meet-the-team/forbes-gray/","links":["https://uk.linkedin.com/in/forbesgray","https://twitter.com/4beez"]},"date":"26 June 2022 10:30"}},"context":{}}